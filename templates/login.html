<head>
  <script type="text/javascript">
	  (function() {
	    var po = document.createElement('script');
	    po.type = 'text/javascript'; po.async = true;
	    po.src = 'https://plus.google.com/js/client:plusone.js';
	    var s = document.getElementsByTagName('script')[0];
	    s.parentNode.insertBefore(po, s);
	  })();
  </script>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" ></script>
	<link rel="stylesheet" href="static/css/logged_out.css">
</head>
<body>
    <img src="static/img/weebly-full-logo.png" id="weebly">
    <button class="g-signin" data-scope="https://www.googleapis.com/auth/plus.login" data-theme="dark"
    	data-cookiepolicy="single_host_origin" data-clientId="{{data.client_id}}" data-callback="loginCallback">
      <img src="static/img/google-oauth.png" id="loginButton">
    </button>
</body>

<script type="text/javascript">

function loginCallback(authResult) {
  if (authResult['access_token']) {
		$.ajax({
			type: 'POST',
			url: window.location.href + '../connect?certificate={{data.certificate}}',
			contentType: 'application/octet-stream; charset=utf-8',
			success: function(result) {
		  		window.location.href = "../"
			},
			processData: false,
			data: authResult.code
		});
  } else if (authResult['error']) {
    console.log('There was an error: ' + authResult['error']);
  }
}

</script>